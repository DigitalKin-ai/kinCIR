{
  "active": true,
  "connections": {
    "Nico reçoit un email": {
      "main": [
        [
          {
            "node": "IF est une commande",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF est une commande": {
      "main": [
        [
          {
            "node": "Get Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Email": {
      "main": [
        [
          {
            "node": "mission",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ACCOUNT MANAGER : Gestionnaire de la relation client": {
      "main": [
        [
          {
            "node": "message1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Stockage et Envoi du Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Questionneur de Documents": {
      "ai_tool": [
        [
          {
            "node": "ACCOUNT MANAGER : Gestionnaire de la relation client",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Rédacteur de Document": {
      "ai_tool": [
        [
          {
            "node": "ACCOUNT MANAGER : Gestionnaire de la relation client",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "ScratchPad": {
      "ai_tool": [
        [
          {
            "node": "ACCOUNT MANAGER : Gestionnaire de la relation client",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "message": {
      "main": [
        [
          {
            "node": "Documents",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Documents": {
      "main": [
        [
          {
            "node": "Get Assistant",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Assistant": {
      "main": [
        [
          {
            "node": "ACCOUNT MANAGER : Gestionnaire de la relation client",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RESSOURCES IA": {
      "ai_tool": [
        [
          {
            "node": "ACCOUNT MANAGER : Gestionnaire de la relation client",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "message1": {
      "main": [
        [
          {
            "node": "Rédacteur d'Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mission": {
      "main": [
        [
          {
            "node": "message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2023-12-17T21:34:00.231Z",
  "id": "hC7WoWW2uTYj0lot",
  "meta": null,
  "name": "Account Manager",
  "nodes": [
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyX",
              "value": 3,
              "unit": "minutes"
            }
          ]
        },
        "filters": {}
      },
      "id": "7b424c87-55ac-4d74-9b75-44f112ff71a0",
      "name": "Nico reçoit un email",
      "type": "n8n-nodes-base.gmailTrigger",
      "typeVersion": 1,
      "position": [
        -220,
        -320
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.Subject.toLowerCase() }}",
              "operation": "contains",
              "value2": "kincir"
            },
            {
              "value1": "={{ $json.From }}",
              "operation": "notEqual",
              "value2": "mailer-daemon@googlemail.com"
            },
            {
              "value1": "={{ $json.From }}",
              "operation": "notEqual",
              "value2": "l.reynolds@digitalkin.ai"
            }
          ]
        }
      },
      "id": "89e30844-13d2-4e72-9c87-92850a6ceb03",
      "name": "IF est une commande",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        0,
        -320
      ]
    },
    {
      "parameters": {
        "operation": "get",
        "messageId": "={{ $json.id }}"
      },
      "id": "d7067ed8-bef7-44a3-8068-9cbe915b1483",
      "name": "Get Email",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        220,
        -320
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "assistantId": "asst_usns6lJ8oyA82LlY5kcC3lOh",
        "text": "=# Documents disponibles via les Outils Questionneur  et Rédacteur de Document\n\n{{ $node[\"Documents\"].json.documentsDisponibles }}\n\n{{ $node[\"message\"].json.message }}",
        "nativeTools": [
          "code_interpreter",
          "retrieval"
        ],
        "options": {}
      },
      "id": "79a6cd5e-ae79-4f06-a50f-dd10c332bc79",
      "name": "ACCOUNT MANAGER : Gestionnaire de la relation client",
      "type": "@n8n/n8n-nodes-langchain.openAiAssistant",
      "typeVersion": 1,
      "position": [
        240,
        160
      ],
      "credentials": {
        "openAiApi": {
          "id": "WY3bm7GCb9qfewyS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "name": "redacteur_de_document",
        "description": "Rédige une version améliorée d'un passage du document demandé à partir d'une demande détaillée",
        "workflowId": "0T67aHjuqQEnrTN0",
        "fields": {
          "values": [
            {
              "name": "kin",
              "stringValue": "={{ $node[\"mission\"].json[\"kin\"] }}"
            },
            {
              "name": "demandeur",
              "stringValue": "={{ $node[\"Get Assistant\"].json.name }}"
            },
            {
              "name": "demandeurId",
              "stringValue": "={{ $node[\"Get Assistant\"].json.id }}"
            },
            {
              "name": "producteurId",
              "stringValue": "=asst_RMuliVrHho2VxBhfZBG1cnTN"
            },
            {
              "name": "contexte",
              "stringValue": "={{ $node[\"message\"].json.contexte }}"
            },
            {
              "name": "intentionDUsage",
              "stringValue": "={{ $node[\"message\"].json.intentionDUsage }}"
            }
          ]
        }
      },
      "id": "ac3c7c6a-ae32-417e-9f96-e6a9735ba012",
      "name": "Rédacteur de Document",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 1,
      "position": [
        120,
        540
      ]
    },
    {
      "parameters": {
        "name": "questionneur_de_documents",
        "description": "Donne une réponse précise issues du document demandé à partir d'un besoin informationnel.",
        "workflowId": "ebLHEt0swZVT9tks",
        "fields": {
          "values": [
            {
              "name": "kin",
              "stringValue": "={{ $node[\"mission\"].json[\"kin\"] }}"
            },
            {
              "name": "demandeur",
              "stringValue": "={{ $node[\"Get Assistant\"].json.name }}"
            },
            {
              "name": "demandeurId",
              "stringValue": "={{ $node[\"Get Assistant\"].json.id }}"
            },
            {
              "name": "producteurId",
              "stringValue": "=langchain"
            },
            {
              "name": "contexte",
              "stringValue": "={{ $node[\"message\"].json.contexte }}"
            },
            {
              "name": "intentionDUsage",
              "stringValue": "={{ $node[\"message\"].json.intentionDUsage }}"
            }
          ]
        }
      },
      "id": "d8c7a246-175f-4c3b-9304-027723fd5875",
      "name": "Questionneur de Documents",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 1,
      "position": [
        -20,
        540
      ]
    },
    {
      "parameters": {
        "name": "scratchpad",
        "description": "Crée une copie temporaire de toi même, sans les accès aux fonctions, afin de pouvoir répondre aux demandes de génération textuelles et de reflexion (exemples : prendre le temps de rédiger, faire plusieurs itérations pour améliorer un texte, etc.), à partir d'une demande précise et détaillée donnée en entrée.",
        "workflowId": "wTbd0CgnGrumh0qf",
        "fields": {
          "values": [
            {
              "name": "kin",
              "stringValue": "={{ $node[\"mission\"].json[\"kin\"] }}"
            },
            {
              "name": "demandeur",
              "stringValue": "={{ $node[\"Get Assistant\"].json.name }}"
            },
            {
              "name": "demandeurId",
              "stringValue": "={{ $node[\"Get Assistant\"].json.id }}"
            },
            {
              "name": "producteurId",
              "stringValue": "=langchain"
            },
            {
              "name": "contexte",
              "stringValue": "={{ $node[\"message\"].json.contexte }}"
            },
            {
              "name": "intentionDUsage",
              "stringValue": "={{ $node[\"message\"].json.intentionDUsage }}"
            }
          ]
        }
      },
      "id": "0331d419-b764-4999-98b6-74ecf20ebae1",
      "name": "ScratchPad",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 1,
      "position": [
        660,
        540
      ]
    },
    {
      "parameters": {
        "url": "=https://api.openai.com/v1/assistants/{{ $('message').item.json[\"producteurId\"] }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openAiApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "OpenAI-Beta",
              "value": "assistants=v1"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "Bearer",
              "value": "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"
            }
          ]
        },
        "options": {}
      },
      "id": "55dfda8c-1333-4e7d-9395-6fcea007b0e6",
      "name": "Get Assistant",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        20,
        160
      ],
      "credentials": {
        "openAiApi": {
          "id": "WY3bm7GCb9qfewyS",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "fields": {
          "values": [
            {
              "name": "kin",
              "stringValue": "={{ $json.kin }}"
            },
            {
              "name": "=demandeur",
              "stringValue": "={{ $('Get Email').item.json.From }}"
            },
            {
              "name": "producteurId",
              "stringValue": "=asst_usns6lJ8oyA82LlY5kcC3lOh"
            },
            {
              "name": "contexte",
              "stringValue": "={{ $json.contexte }}"
            },
            {
              "name": "intentionDUsage",
              "stringValue": "={{ $json.intentionDUsage }}"
            },
            {
              "name": "demande",
              "stringValue": "={{ $json.demande }}"
            },
            {
              "name": "message",
              "stringValue": "=# Contexte\n\n{{ $json.contexte }}\n\n# Intention d'Usage\n\n{{ $json.intentionDUsage }}\n\n# Demande de {{ $('Get Email').item.json.From }}\n\nLe {{(() => {\n    const options = { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };\n    return new Date().toLocaleString('fr-FR', options);\n})(); }}\nDe : {{ $('Get Email').item.json.From }}\nCc : {{ $('Get Email').item.json.cc }}\n\nSujet : {{ $('Get Email').item.json.Subject }}\nSnippet : {{ $('Get Email').item.json.snippet }}"
            }
          ]
        },
        "options": {}
      },
      "id": "5ed94664-4c54-4a52-b0e1-7c03fe52c814",
      "name": "message",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [
        0,
        -80
      ]
    },
    {
      "parameters": {
        "workflowId": "hD7yCDCuhTu3T774"
      },
      "id": "d0b58f87-7320-4a59-b832-97453ee67915",
      "name": "Documents",
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1,
      "position": [
        220,
        -80
      ]
    },
    {
      "parameters": {
        "name": "ressources_ia",
        "description": "Améliore ton prompt (Assistant) à partir d'un problème à résoudre ou demande d'amélioration. Gère les problèmes de performance personnels des Assistants.",
        "workflowId": "f4z3JUKhsFgmKRgZ",
        "fields": {
          "values": [
            {
              "name": "kin",
              "stringValue": "={{ $node[\"mission\"].json[\"kin\"] }}"
            },
            {
              "name": "demandeur",
              "stringValue": "={{ $node[\"Get Assistant\"].json.name }}"
            },
            {
              "name": "demandeurId",
              "stringValue": "={{ $node[\"Get Assistant\"].json.id }}"
            },
            {
              "name": "producteurId",
              "stringValue": "=asst_RMuliVrHho2VxBhfZBG1cnTN"
            },
            {
              "name": "contexte",
              "stringValue": "={{ $node[\"message\"].json.contexte }}"
            },
            {
              "name": "intentionDUsage",
              "stringValue": "={{ $node[\"message\"].json.intentionDUsage }}"
            }
          ]
        }
      },
      "id": "a58c593b-0318-42e8-b724-d1f8a9ee4d98",
      "name": "RESSOURCES IA",
      "type": "@n8n/n8n-nodes-langchain.toolWorkflow",
      "typeVersion": 1,
      "position": [
        420,
        680
      ]
    },
    {
      "parameters": {
        "workflowId": "rr8aeSM8QYyY8Po4"
      },
      "id": "b424df39-e380-483b-9d0b-735076bd17e6",
      "name": "Rédacteur d'Email",
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1,
      "position": [
        840,
        160
      ]
    },
    {
      "parameters": {
        "fields": {
          "values": [
            {
              "name": "kin",
              "stringValue": "={{ $node[\"mission\"].json.kin }}"
            },
            {
              "name": "demandeur",
              "stringValue": "={{ $node[\"Get Assistant\"].json.name }}"
            },
            {
              "name": "demandeurId",
              "stringValue": "={{ $node[\"Get Assistant\"].json.id }}"
            },
            {
              "name": "producteurId",
              "stringValue": "={{ $node[\"Get Assistant\"].json.id }}"
            },
            {
              "name": "contexte",
              "stringValue": "={{ $node[\"mission\"].json.contexte }}"
            },
            {
              "name": "intentionDUsage",
              "stringValue": "={{ $node[\"mission\"].json.intentionDUsage }}"
            },
            {
              "name": "demande",
              "stringValue": "={{ $json.output }}"
            },
            {
              "name": "message",
              "stringValue": "=# Contexte\n\n{{ $node[\"mission\"].json.contexte }}\n\n# Intention d'Usage\n\n{{ $node[\"mission\"].json.intentionDUsage }}\n\n# Demande de {{ $node[\"Get Assistant\"].json.name }}\n\n{{ $json.output }}"
            },
            {
              "name": "messageId",
              "stringValue": "={{ $('Get Email').item.json[\"id\"] }}"
            },
            {
              "name": "to",
              "stringValue": "={{ $('Get Email').item.json[\"To\"] }}"
            },
            {
              "name": "cc",
              "stringValue": "={{ $('Get Email').item.json[\"cc\"] }}"
            },
            {
              "name": "from",
              "stringValue": "={{ $('Get Email').item.json[\"from\"] }}"
            }
          ]
        },
        "options": {}
      },
      "id": "35a4b9ba-fd01-408c-9783-dae9a0b4e62d",
      "name": "message1",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [
        600,
        160
      ]
    },
    {
      "parameters": {
        "workflowId": "j0SCDvxSSQWIWFIO"
      },
      "id": "6b88275a-240c-4d7d-b212-b12c74f41943",
      "name": "Stockage et Envoi du Message",
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1,
      "position": [
        600,
        -40
      ]
    },
    {
      "parameters": {
        "fields": {
          "values": [
            {
              "name": "kin",
              "stringValue": "=kincir_dynergie"
            },
            {
              "name": "demandeur",
              "stringValue": "Sébastien"
            },
            {
              "name": "demandeurId",
              "stringValue": "=asst_K25pMgsChtj1PKEenv0pM8LZ"
            },
            {
              "name": "producteurId",
              "stringValue": "asst_K25pMgsChtj1PKEenv0pM8LZ"
            },
            {
              "name": "contexte",
              "stringValue": "=L’entreprise WeDressFair est spécialisée dans la mode durable et éthique. \\nActivité : Elle identifie et certifie des fabricants d’articles de mode durable et éthique, fait la promotion de leurs articles soulignant l’aspect durable et éthique, et commercialise leurs articles via internet et ses boutiques.\\n\\nLe but de l’entreprise est d’augmenter la part de mode durable et éthique dans la mode.\\nLe principal objectif de recherche est de parvenir à influencer la consommation, et la production, d’articles de mode responsable et éthique.\\nLes thématiques de recherche sont :  \\nParvenir à influencer les consommateurs à réaliser des achats de vêtements provenant de marques responsables et éthiques.  \\nParvenir à influencer les marques à produire des vêtements responsables et éthiques.\\nParvenir à montrer l’impact de nos activités sur la consommation de biens de mode et mesurer cet impact sur l’environnement."
            },
            {
              "name": "intentionDUsage",
              "stringValue": "=Ces éléments seront utilisés pour démontrer l'éligibilité au dispositif CRÉDIT IMPÔT RECHERCHE (CIR) de travaux de recherche sur le thème de la mode durable, dans le cadre d'un rescrit CIR."
            },
            {
              "name": "demande",
              "stringValue": "={{ $json.chat_input }}{{ $json[\"message\"][\"text\"] }}\n\nConseil :Utilise dans l'ordre :\n1) Questionneur de docs\n2) Checheur\n3) Rédacteur de doc\n4) ScratchPad"
            }
          ]
        },
        "options": {}
      },
      "id": "005047b2-18d6-40c5-a4c4-dfa0c5041d37",
      "name": "mission",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [
        -220,
        -80
      ]
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "any"
  },
  "staticData": {
    "node:Nico reçoit un email": {
      "lastTimeChecked": 1703069200,
      "possibleDuplicates": [
        "18c86d5e1c50f4a6"
      ]
    }
  },
  "tags": [
    {
      "createdAt": "2023-12-17T21:33:59.044Z",
      "updatedAt": "2023-12-17T21:33:59.044Z",
      "id": "cV0ITFyTfPijMrvR",
      "name": "kin"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2023-12-20T10:51:16.000Z",
  "versionId": "5a9970ac-b445-4360-afff-7edf140461ee"
}