{
  "active": false,
  "connections": {
    "If document not empty": {
      "main": [
        [
          {
            "node": "4 attachments",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send Email without attachment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If not kinmail": {
      "main": [
        [
          {
            "node": "documentDemandeur",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "documentDemandeur",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "documentDemandeur": {
      "main": [
        [
          {
            "node": "Response formating",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "entree DocumentDemandeur": {
      "main": [
        [
          {
            "node": "If not kinmail",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email without attachment": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Workflow Trigger": {
      "main": [
        [
          {
            "node": "entree DocumentDemandeur",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "3 attachments": {
      "main": [
        [
          {
            "node": "Send Email3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "2 attachments",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "2 attachments": {
      "main": [
        [
          {
            "node": "Send Email2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send Email1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email3": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email2": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email1": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "4 attachments": {
      "main": [
        [
          {
            "node": "Send Email4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "3 attachments",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email4": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Response formating": {
      "main": [
        [
          {
            "node": "If Firebase Data OK",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If Firebase Data OK": {
      "main": [
        [
          {
            "node": "Store response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mail formating",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mail formating": {
      "main": [
        [
          {
            "node": "If document not empty",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Store response": {
      "main": [
        [
          {
            "node": "Mail formating",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2023-12-17T22:40:17.010Z",
  "id": "rr8aeSM8QYyY8Po4",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Send Email",
  "nodes": [
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "return {\"json\": {\"response\": JSON.stringify($json)}};"
      },
      "id": "c11a26c2-b7dd-4c45-bf2c-106a4bb97ee8",
      "name": "response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -920,
        0
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose"
          },
          "conditions": [
            {
              "id": "6834f38a-925c-420d-855f-15a8b07bdc5e",
              "leftValue": "={{ $node[\"documentDemandeur\"].document }}",
              "rightValue": 0,
              "operator": {
                "type": "array",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "8e29e9e0-125a-485e-afeb-884035a37b61",
              "leftValue": "={{ $node[\"documentDemandeur\"].json.document }}",
              "rightValue": 0,
              "operator": {
                "type": "array",
                "operation": "lengthGt",
                "rightType": "number"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "looseTypeValidation": true
        }
      },
      "id": "47148ce4-5905-48a7-a583-48467336a185",
      "name": "If document not empty",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -1580,
        100
      ]
    },
    {
      "parameters": {
        "errorMessage": "={{ \"Data mission : \" + JSON.stringify($json) }}"
      },
      "id": "8f85e234-2ec4-4c4f-8a53-9917f4a0d40a",
      "name": "Stop and Error",
      "type": "n8n-nodes-base.stopAndError",
      "typeVersion": 1,
      "position": [
        -1580,
        -300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose"
          },
          "conditions": [
            {
              "id": "6834f38a-925c-420d-855f-15a8b07bdc5e",
              "leftValue": "={{ $node[\"entree DocumentDemandeur\"].json.kin !== \"kinmail\" }}",
              "rightValue": "md",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "looseTypeValidation": true
        }
      },
      "id": "6af34077-da29-4ee5-8d27-0b187bfae053",
      "name": "If not kinmail",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -2420,
        0
      ]
    },
    {
      "parameters": {
        "workflowId": "H3fxaSnxjZT6EGhc",
        "options": {}
      },
      "id": "c17f7e19-7fd3-4f99-98d4-957589a92d63",
      "name": "documentDemandeur",
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1,
      "position": [
        -2180,
        0
      ]
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let json = $node[\"Execute Workflow Trigger\"].json;\n\nif (json.kinDemandeur && json.kinDemandeur !== \"undefined\") {\n  json.kin = json.kinDemandeur;\n}\n\nif (json.missionIdDemandeur && json.missionIdDemandeur !== \"undefined\") {\n  json.missionId = json.missionIdDemandeur;\n}\n\n\nif (json.missionDemandeur && json.missionDemandeur !== \"undefined\") {\n  json.mission = json.missionDemandeur;\n}\n\nreturn {\"json\": json};"
      },
      "id": "944ba1bf-168f-4da3-ad97-b365252e5d76",
      "name": "entree DocumentDemandeur",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2640,
        0
      ]
    },
    {
      "parameters": {},
      "id": "ad816c39-fc1b-4e1a-90d9-4254ec9e9b4b",
      "name": "Execute Workflow Trigger",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1,
      "position": [
        -2880,
        0
      ]
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"entree DocumentDemandeur\"].json[\"mailId\"]?$node[\"entree DocumentDemandeur\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "message": "=<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\">\n<title>{{ $node[\"entree DocumentDemandeur\"].json.threadSubject }}</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 0;\n    padding: 0;\n    background-color: #f4f4f4;\n    color: #333;\n  }\n  .container {\n    width: 80%;\n    margin: auto;\n    background: #fff;\n    padding: 20px;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  }\n  .header, .footer {\n    background: #007bff;\n    color: white;\n    padding: 10px;\n    text-align: center;\n  }\n  .content {\n    margin: 20px 0;\n  }\n  .logo-header, .logo-footer {\n    text-align: center;\n    background-color: #333;\n    padding: 10px;\n  }\n  .logo-header img, .logo-footer img {\n    height: 50px;\n  }\n  .link {\n    color: #007bff;\n    text-decoration: none;\n  }\n  .bold {\n    font-weight: bold;\n  }\n  .progress-symbol {\n    font-size: 20px;\n  }\n  .completed { color: green; }\n  .in-progress { color: blue; }\n  .to-improve { color: yellow; }\n  .not-started { color: red; }\n</style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"logo-header\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n    <div class=\"header\">\n      <h1>{{ $node[\"entree DocumentDemandeur\"].json.threadSubject }}</h1>\n    </div>\n    <div class=\"content\">\n{{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }} :\n    </div>\n    <div class=\"content\">\n{{ $node[\"Mail formating\"].json.document }}\n    </div>\n    <div class=\"content\">\nLa mission {{ $node[\"entree DocumentDemandeur\"].json.threadSubject }} est terminée !\n    </div>\n    <div class=\"content\">\nDernières instructions :\n    </div>\n    <div class=\"content\">\n{{ [$node[\"Mail formating\"].json.instructions] }}\n    </div>\n    <div class=\"content\">\nAutomatiquement vôtre,\n    </div>\n    <div class=\"content\">\n{{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }}\n    </div>\n    \n    <div class=\"footer\">\n      <span style=\"font-style:italic\">\n\"Travailler ensemble vers l'innovation et le progrès.\"\n      </span>\n    </div>\n    <div class=\"logo-footer\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {
          "ccList": "={{ $node[\"entree DocumentDemandeur\"].json[\"to\"] ? $node[\"entree DocumentDemandeur\"].json[\"to\"] + \", \" : \"\"}} team@digitalkin.ai",
          "senderName": "={{ $node[\"entree DocumentDemandeur\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "fb119fef-b38a-4329-86db-1ee27c837b5f",
      "name": "Send Email without attachment",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1340,
        500
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "content": "## todo : verif html",
        "height": 242.93837168213102,
        "width": 222.22749178240048
      },
      "id": "23302864-b71d-441d-bb32-d8f48e2dfcfe",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2940,
        -60
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose"
          },
          "conditions": [
            {
              "id": "6834f38a-925c-420d-855f-15a8b07bdc5e",
              "leftValue": "={{ Object.keys($binary).length>2 }}",
              "rightValue": "md",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "looseTypeValidation": true
        }
      },
      "id": "5e806044-aa25-4030-b65a-8c3fa8cf4688",
      "name": "3 attachments",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -1340,
        0
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose"
          },
          "conditions": [
            {
              "id": "6834f38a-925c-420d-855f-15a8b07bdc5e",
              "leftValue": "={{ Object.keys($binary).length>1 }}",
              "rightValue": "md",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "looseTypeValidation": true
        }
      },
      "id": "cff66d35-24e9-4dc3-bf2d-45f1d107044a",
      "name": "2 attachments",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -1340,
        280
      ]
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"entree DocumentDemandeur\"].json[\"mailId\"]?$node[\"entree DocumentDemandeur\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "emailType": "text",
        "message": "={{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }} :\n\nLa mission {{ $node[\"entree DocumentDemandeur\"].json.threadSubject }} est terminée !\n\nDernières instructions :\n\n{{ $node[\"entree DocumentDemandeur\"].json.instructions }}\n\nAutomatiquement vôtre,\n\n{{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }}",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "={{ Object.keys($binary)[0] }}"
              }
            ]
          },
          "ccList": "={{ $node[\"entree DocumentDemandeur\"].json[\"to\"] ? $node[\"entree DocumentDemandeur\"].json[\"to\"] + \", \" : \"\"}} team@digitalkin.ai",
          "senderName": "={{ $node[\"entree DocumentDemandeur\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "86824131-94a4-410c-b20c-c8c38e08d3b8",
      "name": "Send Email1",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1160,
        500
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"entree DocumentDemandeur\"].json[\"mailId\"]?$node[\"entree DocumentDemandeur\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "emailType": "text",
        "message": "={{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }} :\n\nLa mission {{ $node[\"entree DocumentDemandeur\"].json.threadSubject }} est terminée !\n\nDernières instructions :\n\n{{ $node[\"entree DocumentDemandeur\"].json.instructions }}\n\nAutomatiquement vôtre,\n\n{{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }}",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "={{ Object.keys($binary)[0] }}"
              },
              {
                "property": "={{ Object.keys($binary)[1] }}"
              }
            ]
          },
          "ccList": "={{ $node[\"entree DocumentDemandeur\"].json[\"to\"] ? $node[\"entree DocumentDemandeur\"].json[\"to\"] + \", \" : \"\"}} team@digitalkin.ai",
          "senderName": "={{ $node[\"entree DocumentDemandeur\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "7774dd2b-2c63-48ab-ba31-995891f699a8",
      "name": "Send Email2",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1160,
        280
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"entree DocumentDemandeur\"].json[\"mailId\"]?$node[\"entree DocumentDemandeur\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "emailType": "text",
        "message": "={{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }} :\n\nLa mission {{ $node[\"entree DocumentDemandeur\"].json.threadSubject }} est terminée !\n\nDernières instructions :\n\n{{ $node[\"entree DocumentDemandeur\"].json.instructions }}\n\nAutomatiquement vôtre,\n\n{{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }}",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "={{ Object.keys($binary)[0] }}"
              },
              {
                "property": "={{ Object.keys($binary)[1] }}"
              },
              {
                "property": "={{ (Object.keys($binary).length>2)?Object.keys($binary)[2]:null }}"
              }
            ]
          },
          "ccList": "={{ $node[\"entree DocumentDemandeur\"].json[\"to\"] ? $node[\"entree DocumentDemandeur\"].json[\"to\"] + \", \" : \"\"}} team@digitalkin.ai",
          "senderName": "={{ $node[\"entree DocumentDemandeur\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "96e04c34-fc93-4a37-a84d-c509a95714b9",
      "name": "Send Email3",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1160,
        0
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose"
          },
          "conditions": [
            {
              "id": "6834f38a-925c-420d-855f-15a8b07bdc5e",
              "leftValue": "={{ Object.keys($binary).length>3 }}",
              "rightValue": "md",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "looseTypeValidation": true
        }
      },
      "id": "4e2f5aba-00e9-4370-a62f-d19fc8b67a67",
      "name": "4 attachments",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -1340,
        -280
      ]
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"entree DocumentDemandeur\"].json[\"mailId\"]?$node[\"entree DocumentDemandeur\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "emailType": "text",
        "message": "={{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }} :\n\nLa mission {{ $node[\"entree DocumentDemandeur\"].json.threadSubject }} est terminée !\n\nDernières instructions :\n\n{{ $node[\"entree DocumentDemandeur\"].json.instructions }}\n\nAutomatiquement vôtre,\n\n{{ $node[\"entree DocumentDemandeur\"].json.dernierProducteur.toUpperCase() }}",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "={{ Object.keys($binary)[0] }}"
              },
              {
                "property": "={{ Object.keys($binary)[1] }}"
              },
              {
                "property": "={{ Object.keys($binary)[2] }}"
              },
              {
                "property": "={{ Object.keys($binary)[3] }}"
              }
            ]
          },
          "ccList": "={{ $node[\"entree DocumentDemandeur\"].json[\"to\"] ? $node[\"entree DocumentDemandeur\"].json[\"to\"] + \", \" : \"\"}} team@digitalkin.ai",
          "senderName": "={{ $node[\"entree DocumentDemandeur\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "8c1898de-bb72-4676-807c-de0cdd0baa9a",
      "name": "Send Email4",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1160,
        -280
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "content": "## Store in Firebase",
        "height": 398.52847102955775,
        "width": 534.2325776155644
      },
      "id": "982b1710-71c1-4330-9f93-973ffc5eaa14",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1960,
        -160
      ]
    },
    {
      "parameters": {
        "content": "## DATA MISSING",
        "height": 191.9504214838582,
        "width": 212.69045033526618
      },
      "id": "7ae06558-df17-45e6-b5e6-800485a636d2",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1640,
        -360
      ]
    },
    {
      "parameters": {
        "content": "## Get Document\nhttps://kins.app.n8n.cloud/workflow/H3fxaSnxjZT6EGhc",
        "height": 276.1083494686582,
        "width": 250.71967654986526
      },
      "id": "a942e3b6-7561-4238-96d8-4e403cd44c03",
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2260,
        -120
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose"
          },
          "conditions": [
            {
              "id": "6834f38a-925c-420d-855f-15a8b07bdc5e",
              "leftValue": "={{ $node[\"Execute Workflow Trigger\"].json.mailId }}",
              "rightValue": "md",
              "operator": {
                "type": "string",
                "operation": "notExists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {
          "looseTypeValidation": true
        }
      },
      "id": "e66caf7c-d041-4ca0-8d1d-5302628bf4ee",
      "name": "If not mail",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -1820,
        -1020
      ]
    },
    {
      "parameters": {
        "jsCode": "let json = {};\n\njson.role = \"Kin\";\njson.status = $node[\"documentDemandeur\"].json.status;\njson.content = $node[\"documentDemandeur\"].json.instructions;\njson.createdAt = $node[\"documentDemandeur\"].json.date;\njson.id = $node[\"documentDemandeur\"].json.executionId;\njson.originId = $node[\"documentDemandeur\"].json.threadId;\njson.assignment = $node[\"documentDemandeur\"].json.mission;\njson.model = $node[\"documentDemandeur\"].json.kin;\n\nreturn json;"
      },
      "id": "469a637e-b221-4a0c-b055-fb6ed79c4e70",
      "name": "Response formating",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1920,
        0
      ]
    },
    {
      "parameters": {
        "content": "## Return\nSend email AND store in firebase\n\nError ? -> Send Email",
        "height": 268.82458714425053
      },
      "id": "831ba155-fced-47e9-b084-156a9337fe66",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -680,
        -360
      ]
    },
    {
      "parameters": {
        "jsCode": "let json = $node[\"documentDemandeur\"].json;\n\nfunction splitOnNewline(str) {\n  if (typeof str !== 'string') {\n    str = String(str);\n  }\n  return str.split('\\n');\n}\n\nfunction escapeHtml(unsafe) {\n  return unsafe\n    .replace(/Ã /g, \"à\")\n    .replace(/Ã¢/g, \"â\")\n    .replace(/Ã©/g, \"é\")\n    .replace(/Ã¨/g, \"è\")\n    .replace(/Ãª/g, \"ê\")\n    .replace(/Ã«/g, \"ë\")\n    .replace(/Ã®/g, \"î\")\n    .replace(/Ã¯/g, \"ï\")\n    .replace(/Ã´/g, \"ô\")\n    .replace(/Ã¹/g, \"ù\")\n    .replace(/Ã»/g, \"û\")\n    .replace(/Ã¼/g, \"ü\")\n    .replace(/Ã¿/g, \"ÿ\")\n    .replace(/Ã€/g, \"À\")\n    .replace(/Ã‚/g, \"Â\")\n    .replace(/Ã‰/g, \"É\")\n    .replace(/Ãˆ/g, \"È\")\n    .replace(/ÃŠ/g, \"Ê\")\n    .replace(/Ã‹/g, \"Ë\")\n    .replace(/ÃŽ/g, \"Î\")\n    .replace(/Ã/g, \"Ï\")\n    .replace(/Ã”/g, \"Ô\")\n    .replace(/Ã™/g, \"Ù\")\n    .replace(/Ã›/g, \"Û\")\n    .replace(/Ãœ/g, \"Ü\")\n    .replace(/ÃŸ/g, \"ß\")\n    .replace(/Ã§/g, \"ç\")\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#039;\");\n}\n\nlet instructions = escapeHtml($node[\"entree DocumentDemandeur\"].json.instructions);\njson.instructions = splitOnNewline(instructions);\nlet document = escapeHtml(json.document).split('\\n');\njson.document = splitOnNewline(document);\n\nreturn json;"
      },
      "id": "731ab728-ddee-4745-8c27-dd901e765f96",
      "name": "Mail formating",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1760,
        100
      ]
    },
    {
      "parameters": {
        "content": "## Formating Firebase\nOutput\n\nrole = \"Kin\"\nstatus = status\ncontent = instructions\ncreatedAt = date\nid = executionId\noriginId = threadId\nassignment = model",
        "height": 292.6143862041808,
        "width": 314.12848184702665
      },
      "id": "c59c33e9-12c2-4eb0-b777-b902b4635fd6",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1960,
        -460
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "15106846-6a72-4b99-970e-8c45d0a0be4e",
              "leftValue": "={{ $json.id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "adff18e1-3e9f-4bcc-94a3-7a95ee7740c2",
              "leftValue": "={{ $json.role }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "58b9419b-21ad-44fd-a51a-d3e4ecd5bde3",
              "leftValue": "={{ $json.status }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "e9d97c33-1497-4fbe-bef2-712a70eab73d",
              "leftValue": "={{ $json.content }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "bc0a9dc3-eb20-460e-a7dd-46608a0e12bd",
              "leftValue": "={{ $json.createdAt }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "debab90b-4c13-4c5b-8be8-70339167c110",
              "leftValue": "={{ $json.assignment }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "2551ab35-e621-4b2c-9154-2795d51fbab4",
              "leftValue": "={{ $json.model }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "cfc04e96-cabb-424b-a431-d03d65b9c415",
      "name": "If Firebase Data OK",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -1760,
        -100
      ]
    },
    {
      "parameters": {
        "projectId": "kincir-9369f-default-rtdb",
        "path": "={{ \"conversations/\" + $node[\"Response formating\"].json.originId + \"/responses/\" + $node[\"Response formating\"].json.id }}",
        "attributes": "id, originId, assignment, role, status, model, content, createdAt"
      },
      "id": "f14b493a-a2de-4c2c-8b58-a7e0b7d62b82",
      "name": "Store response",
      "type": "n8n-nodes-base.googleFirebaseRealtimeDatabase",
      "typeVersion": 1,
      "position": [
        -1580,
        -100
      ],
      "credentials": {
        "googleFirebaseRealtimeDatabaseOAuth2Api": {
          "id": "OVSbgNbwKqSqujMP",
          "name": "Google Firebase Realtime Database account"
        }
      }
    }
  ],
  "pinData": {
    "Execute Workflow Trigger": [
      {
        "json": {
          "commandText": "done",
          "date": "2024-02-13T03:24:29.484+01:00",
          "dernierProducteur": "kindemand",
          "execution": "doing",
          "executionId": "193651",
          "firstAttribute": "kindemand",
          "instructions": "TODOLIST :\n\n- DONE : Analyser la mission et dÃ©finir les critÃ¨res de recherche.\n- DONE : RÃ©aliser une recherche approfondie sur les technologies d'extraction de donnÃ©es Ã  partir de documents PDF. Les points suivants doivent Ãªtre abordÃ©s :\n  - Identifier les technologies d'extraction de donnÃ©es disponibles sur le marchÃ©.\n  - RÃ©aliser une comparaison dÃ©taillÃ©e en termes de prÃ©cision, de gestion des documents complexes, de coÃ»ts, et de facilitÃ© d'intÃ©gration.\n  - Recueillir des avis d'experts et des cas d'utilisation rÃ©ussis.\n- TODO : PrÃ©parer un rapport comprenant un rÃ©sumÃ© des technologies Ã©tudiÃ©es, une comparaison dÃ©taillÃ©e, et une recommandation finale en fonction des critÃ¨res Ã©tablis.\n\nProchaine action Ã  rÃ©aliser & instructions :\n\nIl est crucial de procÃ©der maintenant Ã  la prÃ©paration du rapport final. Ce rapport doit inclure :\n- Un rÃ©sumÃ© des technologies Ã©tudiÃ©es,\n- Une comparaison dÃ©taillÃ©e selon les critÃ¨res prÃ©dÃ©finis (prÃ©cision, gestion des documents complexes, coÃ»t, facilitÃ© d'intÃ©gration),\n- Une recommandation finale en vue de la sÃ©lection de la technologie la plus adaptÃ©e.\n\nAssurez-vous de structurer le rapport clairement, en dÃ©limitant chaque section selon les points mentionnÃ©s. La prÃ©sentation doit Ãªtre soignÃ©e et professionnelle, mettant en avant les analyses et les recommandations de faÃ§on concise et argumentÃ©e.\n\nCette Ã©tape est cruciale pour conclure la mission efficacement. Le rapport contribuera de maniÃ¨re significative Ã  la prise de dÃ©cision finale et doit donc Ãªtre rÃ©digÃ© avec attention et prÃ©cision.",
          "kin": "kindemand",
          "mission": "Demande de Recherche d'Informations sur les Technologies d'Extraction de Données\n\nAfin de sélectionner et d'implémenter la solution la plus efficace pour l'extraction de données depuis le document PDF '2301176_PRODOTTOFINITO_03-02-2023.pdf', il est nécessaire d'obtenir des informations mises à jour sur les technologies d'extraction de données actuelles. Cette demande vise à recueillir des recommandations sur les outils et technologies d'extraction de données les plus avancés et adaptés aux besoins du projet, ainsi que les coûts, les exigences en matière de ressources, et les délais de mise en œuvre associés.\n\nObjectif : \n- Identifier les technologies d'extraction de données les plus performantes disponibles sur le marché.\n- Obtenir une comparaison détaillée en termes de précision, de gestion des documents complexes, de coûts et de facilité d'intégration.\n- Recueillir des avis d'experts et des cas d'utilisation réussis pour éclairer la décision finale.\n\nLa réponse à cette demande aidera à éclairer le processus de sélection de la solution d'extraction de données et à planifier efficacement son implémentatio",
          "missionId": "kindemand-undefined",
          "missionIdDemandeur": "KinDev-undefined",
          "status": "done"
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "any"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2023-12-17T10:07:55.424Z",
      "updatedAt": "2023-12-20T20:25:13.009Z",
      "id": "DzuSxffpFOEBRhld",
      "name": "outil"
    },
    {
      "createdAt": "2024-01-21T09:47:18.925Z",
      "updatedAt": "2024-01-21T09:47:18.925Z",
      "id": "G7odwuwbJmUt0XX2",
      "name": "prod"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2024-02-15T15:41:22.000Z",
  "versionId": "abbc710f-faf0-4329-8f16-bc263a88595c"
}