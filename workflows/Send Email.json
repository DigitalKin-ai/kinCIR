{
  "active": false,
  "connections": {
    "Send Email without attachment": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Workflow Trigger": {
      "main": [
        [
          {
            "node": "/crud_mission/read",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email3": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email2": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email1": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Email4": {
      "main": [
        [
          {
            "node": "response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If Firebase Data OK": {
      "main": [
        [
          {
            "node": "Store response",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Mail formatting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Store response": {
      "main": [
        [
          {
            "node": "Mail formatting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Response formatting": {
      "main": [
        [
          {
            "node": "If Firebase Data OK",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "/crud_mission/read": {
      "main": [
        [
          {
            "node": "CRUD Mission : Read",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CRUD Mission : Read": {
      "main": [
        [
          {
            "node": "mission",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mission": {
      "main": [
        [
          {
            "node": "document",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "document": {
      "main": [
        [
          {
            "node": "Response formatting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Mail formatting": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Send Email without attachment",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send Email1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send Email2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send Email3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Send Email4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Stop and Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2023-12-17T22:40:17.010Z",
  "id": "rr8aeSM8QYyY8Po4",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Send Email",
  "nodes": [
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "return {\"json\": {\"response\": JSON.stringify($json)}};"
      },
      "id": "c11a26c2-b7dd-4c45-bf2c-106a4bb97ee8",
      "name": "response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -900,
        80
      ]
    },
    {
      "parameters": {
        "errorMessage": "={{ \"Data mission : \" + JSON.stringify($json) }}"
      },
      "id": "8f85e234-2ec4-4c4f-8a53-9917f4a0d40a",
      "name": "Stop and Error",
      "type": "n8n-nodes-base.stopAndError",
      "typeVersion": 1,
      "position": [
        -1460,
        380
      ]
    },
    {
      "parameters": {},
      "id": "ad816c39-fc1b-4e1a-90d9-4254ec9e9b4b",
      "name": "Execute Workflow Trigger",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1,
      "position": [
        -3180,
        0
      ]
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"mission\"].json[\"mailId\"]?$node[\"mission\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "message": "=<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\">\n<title>{{ $node[\"mission\"].json.threadSubject }}</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 0;\n    padding: 0;\n    background-color: #f4f4f4;\n    color: #333;\n  }\n  .container {\n    width: 80%;\n    margin: auto;\n    background: #fff;\n    padding: 20px;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  }\n  .header, .footer {\n    background: #007bff;\n    color: white;\n    padding: 10px;\n    text-align: center;\n  }\n  .content {\n    margin: 20px 0;\n  }\n  .logo-header, .logo-footer {\n    text-align: center;\n    background-color: #333;\n    padding: 10px;\n  }\n  .logo-header img, .logo-footer img {\n    height: 50px;\n  }\n  .link {\n    color: #007bff;\n    text-decoration: none;\n  }\n  .bold {\n    font-weight: bold;\n  }\n  .progress-symbol {\n    font-size: 20px;\n  }\n  .completed { color: green; }\n  .in-progress { color: blue; }\n  .to-improve { color: yellow; }\n  .not-started { color: red; }\n</style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"logo-header\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n    <div class=\"header\">\n      <h1>{{ $node[\"mission\"].json.threadSubject }}</h1>\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }} :\n    </div>\n    <div class=\"content\">\nLa mission {{ $node[\"mission\"].json.threadSubject }} est terminée !\n    </div>\n    <div class=\"content\">\nDernières instructions :\n    </div>\n    <div class=\"content\">\n{{ $node[\"Mail formatting\"].json.instructions }}\n    </div>\n    <div class=\"content\">\nAutomatiquement vôtre,\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }}\n    </div>\n    \n    <div class=\"footer\">\n      \n      <span style=\"font-style:italic\">\n\"Libérez le temps humain pour l'humain.\"\n      </span>\n<br>\n      <a href=\"https://digitalkin.ai/\" style=\"color: white; text-decoration: none\">\n      <span style=\"font-style:italic; text-color: white; text-decoration: none\">\nNotre site : https://digitalkin.ai/\n      </span>\n</a>\n    </div>\n    <div class=\"logo-footer\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {
          "ccList": "={{ $node[\"mission\"].json[\"to\"] ? $node[\"mission\"].json[\"to\"] + \", \" : \"\"}}",
          "senderName": "={{ $node[\"mission\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "fb119fef-b38a-4329-86db-1ee27c837b5f",
      "name": "Send Email without attachment",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1140,
        -240
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "content": "## todo : verif html",
        "height": 242.93837168213102,
        "width": 222.22749178240048
      },
      "id": "23302864-b71d-441d-bb32-d8f48e2dfcfe",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -3240,
        -60
      ]
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"mission\"].json[\"mailId\"]?$node[\"mission\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "message": "=<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\">\n<title>{{ $node[\"mission\"].json.threadSubject }}</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 0;\n    padding: 0;\n    background-color: #f4f4f4;\n    color: #333;\n  }\n  .container {\n    width: 80%;\n    margin: auto;\n    background: #fff;\n    padding: 20px;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  }\n  .header, .footer {\n    background: #007bff;\n    color: white;\n    padding: 10px;\n    text-align: center;\n  }\n  .content {\n    margin: 20px 0;\n  }\n  .logo-header, .logo-footer {\n    text-align: center;\n    background-color: #333;\n    padding: 10px;\n  }\n  .logo-header img, .logo-footer img {\n    height: 50px;\n  }\n  .link {\n    color: #007bff;\n    text-decoration: none;\n  }\n  .bold {\n    font-weight: bold;\n  }\n  .progress-symbol {\n    font-size: 20px;\n  }\n  .completed { color: green; }\n  .in-progress { color: blue; }\n  .to-improve { color: yellow; }\n  .not-started { color: red; }\n</style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"logo-header\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n    <div class=\"header\">\n      <h1>{{ $node[\"mission\"].json.threadSubject }}</h1>\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }} :\n    </div>\n    <div class=\"content\">\nLa mission {{ $node[\"mission\"].json.threadSubject }} est terminée !\n    </div>\n    <div class=\"content\">\nDernières instructions :\n    </div>\n    <div class=\"content\">\n{{ $node[\"Mail formatting\"].json.instructions }}\n    </div>\n    <div class=\"content\">\nAutomatiquement vôtre,\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }}\n    </div>\n    \n    <div class=\"footer\">\n      \n      <span style=\"font-style:italic\">\n\"Libérez le temps humain pour l'humain.\"\n      </span>\n<br>\n      <a href=\"https://digitalkin.ai/\" style=\"color: white; text-decoration: none\">\n      <span style=\"font-style:italic; text-color: white; text-decoration: none\">\nNotre site : https://digitalkin.ai/\n      </span>\n</a>\n    </div>\n    <div class=\"logo-footer\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "={{ Object.keys($binary)[0] }}"
              }
            ]
          },
          "ccList": "={{ $node[\"mission\"].json[\"to\"] ? $node[\"mission\"].json[\"to\"] + \", \" : \"\"}}",
          "senderName": "={{ $node[\"mission\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "86824131-94a4-410c-b20c-c8c38e08d3b8",
      "name": "Send Email1",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1140,
        -40
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"mission\"].json[\"mailId\"]?$node[\"mission\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "message": "=<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\">\n<title>{{ $node[\"mission\"].json.threadSubject }}</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 0;\n    padding: 0;\n    background-color: #f4f4f4;\n    color: #333;\n  }\n  .container {\n    width: 80%;\n    margin: auto;\n    background: #fff;\n    padding: 20px;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  }\n  .header, .footer {\n    background: #007bff;\n    color: white;\n    padding: 10px;\n    text-align: center;\n  }\n  .content {\n    margin: 20px 0;\n  }\n  .logo-header, .logo-footer {\n    text-align: center;\n    background-color: #333;\n    padding: 10px;\n  }\n  .logo-header img, .logo-footer img {\n    height: 50px;\n  }\n  .link {\n    color: #007bff;\n    text-decoration: none;\n  }\n  .bold {\n    font-weight: bold;\n  }\n  .progress-symbol {\n    font-size: 20px;\n  }\n  .completed { color: green; }\n  .in-progress { color: blue; }\n  .to-improve { color: yellow; }\n  .not-started { color: red; }\n</style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"logo-header\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n    <div class=\"header\">\n      <h1>{{ $node[\"mission\"].json.threadSubject }}</h1>\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }} :\n    </div>\n    <div class=\"content\">\nLa mission {{ $node[\"mission\"].json.threadSubject }} est terminée !\n    </div>\n    <div class=\"content\">\nDernières instructions :\n    </div>\n    <div class=\"content\">\n{{ $node[\"Mail formatting\"].json.instructions }}\n    </div>\n    <div class=\"content\">\nAutomatiquement vôtre,\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }}\n    </div>\n    \n    <div class=\"footer\">\n      \n      <span style=\"font-style:italic\">\n\"Libérez le temps humain pour l'humain.\"\n      </span>\n<br>\n      <a href=\"https://digitalkin.ai/\" style=\"color: white; text-decoration: none\">\n      <span style=\"font-style:italic; text-color: white; text-decoration: none\">\nNotre site : https://digitalkin.ai/\n      </span>\n</a>\n    </div>\n    <div class=\"logo-footer\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "={{ Object.keys($binary)[0] }}"
              },
              {
                "property": "={{ Object.keys($binary)[1] }}"
              }
            ]
          },
          "ccList": "={{ $node[\"mission\"].json[\"to\"] ? $node[\"mission\"].json[\"to\"] + \", \" : \"\"}}",
          "senderName": "={{ $node[\"mission\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "7774dd2b-2c63-48ab-ba31-995891f699a8",
      "name": "Send Email2",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1140,
        160
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"mission\"].json[\"mailId\"]?$node[\"mission\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "message": "=<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\">\n<title>{{ $node[\"mission\"].json.threadSubject }}</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 0;\n    padding: 0;\n    background-color: #f4f4f4;\n    color: #333;\n  }\n  .container {\n    width: 80%;\n    margin: auto;\n    background: #fff;\n    padding: 20px;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  }\n  .header, .footer {\n    background: #007bff;\n    color: white;\n    padding: 10px;\n    text-align: center;\n  }\n  .content {\n    margin: 20px 0;\n  }\n  .logo-header, .logo-footer {\n    text-align: center;\n    background-color: #333;\n    padding: 10px;\n  }\n  .logo-header img, .logo-footer img {\n    height: 50px;\n  }\n  .link {\n    color: #007bff;\n    text-decoration: none;\n  }\n  .bold {\n    font-weight: bold;\n  }\n  .progress-symbol {\n    font-size: 20px;\n  }\n  .completed { color: green; }\n  .in-progress { color: blue; }\n  .to-improve { color: yellow; }\n  .not-started { color: red; }\n</style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"logo-header\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n    <div class=\"header\">\n      <h1>{{ $node[\"mission\"].json.threadSubject }}</h1>\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }} :\n    </div>\n    <div class=\"content\">\nLa mission {{ $node[\"mission\"].json.threadSubject }} est terminée !\n    </div>\n    <div class=\"content\">\nDernières instructions :\n    </div>\n    <div class=\"content\">\n{{ $node[\"Mail formatting\"].json.instructions }}\n    </div>\n    <div class=\"content\">\nAutomatiquement vôtre,\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }}\n    </div>\n    \n    <div class=\"footer\">\n      \n      <span style=\"font-style:italic\">\n\"Libérez le temps humain pour l'humain.\"\n      </span>\n<br>\n      <a href=\"https://digitalkin.ai/\" style=\"color: white; text-decoration: none\">\n      <span style=\"font-style:italic; text-color: white; text-decoration: none\">\nNotre site : https://digitalkin.ai/\n      </span>\n</a>\n    </div>\n    <div class=\"logo-footer\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "={{ Object.keys($binary)[0] }}"
              },
              {
                "property": "={{ Object.keys($binary)[1] }}"
              },
              {
                "property": "={{ (Object.keys($binary).length>2)?Object.keys($binary)[2]:null }}"
              }
            ]
          },
          "ccList": "={{ $node[\"mission\"].json[\"to\"] ? $node[\"mission\"].json[\"to\"] + \", \" : \"\"}}",
          "senderName": "={{ $node[\"mission\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "96e04c34-fc93-4a37-a84d-c509a95714b9",
      "name": "Send Email3",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1140,
        340
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "operation": "reply",
        "messageId": "={{ $node[\"mission\"].json[\"mailId\"]?$node[\"mission\"].json[\"mailId\"]:\"18d5caf98d8424b9\" }}",
        "message": "=<!DOCTYPE html>\n<html>\n<head>\n<meta http-equiv=\"content-type\" content=\"text/html; charset=UTF-8\">\n<title>{{ $node[\"mission\"].json.threadSubject }}</title>\n<style>\n  body {\n    font-family: Arial, sans-serif;\n    margin: 0;\n    padding: 0;\n    background-color: #f4f4f4;\n    color: #333;\n  }\n  .container {\n    width: 80%;\n    margin: auto;\n    background: #fff;\n    padding: 20px;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n  }\n  .header, .footer {\n    background: #007bff;\n    color: white;\n    padding: 10px;\n    text-align: center;\n  }\n  .content {\n    margin: 20px 0;\n  }\n  .logo-header, .logo-footer {\n    text-align: center;\n    background-color: #333;\n    padding: 10px;\n  }\n  .logo-header img, .logo-footer img {\n    height: 50px;\n  }\n  .link {\n    color: #007bff;\n    text-decoration: none;\n  }\n  .bold {\n    font-weight: bold;\n  }\n  .progress-symbol {\n    font-size: 20px;\n  }\n  .completed { color: green; }\n  .in-progress { color: blue; }\n  .to-improve { color: yellow; }\n  .not-started { color: red; }\n</style>\n</head>\n<body>\n  <div class=\"container\">\n    <div class=\"logo-header\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n    <div class=\"header\">\n      <h1>{{ $node[\"mission\"].json.threadSubject }}</h1>\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }} :\n    </div>\n    <div class=\"content\">\nLa mission {{ $node[\"mission\"].json.threadSubject }} est terminée !\n    </div>\n    <div class=\"content\">\nDernières instructions :\n    </div>\n    <div class=\"content\">\n{{ $node[\"Mail formatting\"].json.instructions }}\n    </div>\n    <div class=\"content\">\nAutomatiquement vôtre,\n    </div>\n    <div class=\"content\">\n{{ $node[\"mission\"].json.dernierProducteur.toUpperCase() }}\n    </div>\n    \n    <div class=\"footer\">\n      \n      <span style=\"font-style:italic\">\n\"Libérez le temps humain pour l'humain.\"\n      </span>\n<br>\n      <a href=\"https://digitalkin.ai/\" style=\"color: white; text-decoration: none\">\n      <span style=\"font-style:italic; text-color: white; text-decoration: none\">\nNotre site : https://digitalkin.ai/\n      </span>\n</a>\n    </div>\n    <div class=\"logo-footer\">\n      <a href=\"https://digitalkin.ai/\">\n        <img src=\"https://images.squarespace-cdn.com/content/v1/62a5afa70a34fc7b525445fa/32223e40-6505-437f-88f5-d2563d8d9493/Logo+and+Textfull_white.png?format=1500w\" alt=\"DigitalKin Logo\">\n      </a>\n    </div>\n  </div>\n</body>\n</html>",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {
                "property": "={{ Object.keys($binary)[0] }}"
              },
              {
                "property": "={{ Object.keys($binary)[1] }}"
              },
              {
                "property": "={{ Object.keys($binary)[2] }}"
              },
              {
                "property": "={{ Object.keys($binary)[3] }}"
              }
            ]
          },
          "ccList": "={{ $node[\"mission\"].json[\"to\"] ? $node[\"entree DocumentDemandeur\"].json[\"to\"] + \", \" : \"\"}}",
          "senderName": "={{ $node[\"mission\"].json.kin.toUpperCase() }}"
        }
      },
      "id": "8c1898de-bb72-4676-807c-de0cdd0baa9a",
      "name": "Send Email4",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -1140,
        520
      ],
      "credentials": {
        "gmailOAuth2": {
          "id": "iPrbr6qZiWHu93N9",
          "name": "Gmail Nicolas"
        }
      }
    },
    {
      "parameters": {
        "content": "## Store in Firebase",
        "height": 398.52847102955775,
        "width": 534.2325776155644
      },
      "id": "982b1710-71c1-4330-9f93-973ffc5eaa14",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1960,
        -160
      ]
    },
    {
      "parameters": {
        "content": "## DATA MISSING",
        "height": 191.9504214838582,
        "width": 212.69045033526618
      },
      "id": "7ae06558-df17-45e6-b5e6-800485a636d2",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1640,
        -360
      ]
    },
    {
      "parameters": {
        "content": "## Get Document\nhttps://kins.app.n8n.cloud/workflow/H3fxaSnxjZT6EGhc",
        "height": 276.1083494686582,
        "width": 250.71967654986526
      },
      "id": "a942e3b6-7561-4238-96d8-4e403cd44c03",
      "name": "Sticky Note14",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2260,
        -120
      ]
    },
    {
      "parameters": {
        "content": "## Return\nSend email AND store in firebase\n\nError ? -> Send Email",
        "height": 268.82458714425053
      },
      "id": "831ba155-fced-47e9-b084-156a9337fe66",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -680,
        -360
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "15106846-6a72-4b99-970e-8c45d0a0be4e",
              "leftValue": "={{ $json.id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "adff18e1-3e9f-4bcc-94a3-7a95ee7740c2",
              "leftValue": "={{ $json.role }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "58b9419b-21ad-44fd-a51a-d3e4ecd5bde3",
              "leftValue": "={{ $json.status }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "e9d97c33-1497-4fbe-bef2-712a70eab73d",
              "leftValue": "={{ $json.content }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "bc0a9dc3-eb20-460e-a7dd-46608a0e12bd",
              "leftValue": "={{ $json.createdAt }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "debab90b-4c13-4c5b-8be8-70339167c110",
              "leftValue": "={{ $json.assignment }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            },
            {
              "id": "2551ab35-e621-4b2c-9154-2795d51fbab4",
              "leftValue": "={{ $json.model }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "cfc04e96-cabb-424b-a431-d03d65b9c415",
      "name": "If Firebase Data OK",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        -1760,
        -100
      ]
    },
    {
      "parameters": {
        "projectId": "kincir-9369f-default-rtdb",
        "path": "={{ \"conversations/\" + $node[\"Response formatting\"].json.originId + \"/responses/\" + $node[\"Response formatting\"].json.id }}",
        "attributes": "id, originId, assignment, role, status, model, content, createdAt"
      },
      "id": "f14b493a-a2de-4c2c-8b58-a7e0b7d62b82",
      "name": "Store response",
      "type": "n8n-nodes-base.googleFirebaseRealtimeDatabase",
      "typeVersion": 1,
      "position": [
        -1580,
        -100
      ],
      "credentials": {
        "googleFirebaseRealtimeDatabaseOAuth2Api": {
          "id": "OVSbgNbwKqSqujMP",
          "name": "Google Firebase Realtime Database account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Formatting Firebase\nOutput\n\nrole = \"Kin\"\nstatus = status\ncontent = instructions\ncreatedAt = date\nid = executionId\noriginId = threadId\nassignment = model",
        "height": 292.6143862041808,
        "width": 314.12848184702665
      },
      "id": "855d1765-6f81-47b2-a42a-47994c4e52d0",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -1960,
        -460
      ]
    },
    {
      "parameters": {
        "jsCode": "let json = {};\n\njson.role = \"Kin\";\njson.status = $node[\"mission\"].json.status;\njson.content = $node[\"mission\"].json.instructions;\njson.createdAt = $node[\"mission\"].json.date;\njson.id = $node[\"mission\"].json.missionId;\njson.originId = $node[\"mission\"].json.threadId;\njson.assignment = $node[\"mission\"].json.mission;\njson.model = $node[\"mission\"].json.kin;\n\nreturn {\"json\": json};"
      },
      "id": "469a637e-b221-4a0c-b055-fb6ed79c4e70",
      "name": "Response formatting",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1920,
        0
      ]
    },
    {
      "parameters": {
        "jsCode": "let json = $node[\"document\"].json;\n\nfunction splitOnNewline(str) {\n  if (typeof str !== 'string') {\n    str = String(str);\n  }\n  return escapeHtml(str).replace(/\\n/g, '<br>');\n}\n\nfunction escapeHtml(unsafe) {\n  return unsafe\n    .replace(/Ã /g, \"à\")\n    .replace(/Ã¢/g, \"â\")\n    .replace(/Ã©/g, \"é\")\n    .replace(/Ã¨/g, \"è\")\n    .replace(/Ãª/g, \"ê\")\n    .replace(/Ã«/g, \"ë\")\n    .replace(/Ã®/g, \"î\")\n    .replace(/Ã¯/g, \"ï\")\n    .replace(/Ã´/g, \"ô\")\n    .replace(/Ã¹/g, \"ù\")\n    .replace(/Ã»/g, \"û\")\n    .replace(/Ã¼/g, \"ü\")\n    .replace(/Ã¿/g, \"ÿ\")\n    .replace(/Ã€/g, \"À\")\n    .replace(/Ã‚/g, \"Â\")\n    .replace(/Ã‰/g, \"É\")\n    .replace(/Ãˆ/g, \"È\")\n    .replace(/ÃŠ/g, \"Ê\")\n    .replace(/Ã‹/g, \"Ë\")\n    .replace(/ÃŽ/g, \"Î\")\n    .replace(/Ã/g, \"Ï\")\n    .replace(/Ã”/g, \"Ô\")\n    .replace(/Ã™/g, \"Ù\")\n    .replace(/Ã›/g, \"Û\")\n    .replace(/Ãœ/g, \"Ü\")\n    .replace(/ÃŸ/g, \"ß\")\n    .replace(/Ã§/g, \"ç\")\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#039;\");\n}\n\njson.instructions = splitOnNewline($node[\"mission\"].json.instructions);\n\nreturn {\"json\": json, \"binary\": $node[\"document\"].binary};"
      },
      "id": "731ab728-ddee-4745-8c27-dd901e765f96",
      "name": "Mail formatting",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1760,
        100
      ]
    },
    {
      "parameters": {
        "content": "## CRUD Mission\nhttps://kins.app.n8n.cloud/workflow/HLDDZOmG8kuk2zTi",
        "height": 274.5517166627047,
        "width": 250.71967654986526
      },
      "id": "cadee00a-7446-45c2-9fbb-eef45a78c2ee",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2760,
        -100
      ]
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let json = $json;\n\njson.query = \"/crud_mission/read/\" + $json.missionId;\njson.responseFormat = \"json\";\n\nreturn {\"json\": json};"
      },
      "id": "b5b43019-2bbd-4431-ae08-cb8496ff2522",
      "name": "/crud_mission/read",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2900,
        0
      ]
    },
    {
      "parameters": {
        "workflowId": "HLDDZOmG8kuk2zTi",
        "options": {}
      },
      "id": "5cc5fd06-c8a7-4686-9f79-a8ceb5abe088",
      "name": "CRUD Mission : Read",
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1,
      "position": [
        -2680,
        0
      ]
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "let json = $json;\n\nreturn {\"json\": json};"
      },
      "id": "fe2f25c1-c336-4298-83eb-fe84ddb9c68e",
      "name": "mission",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2440,
        0
      ]
    },
    {
      "parameters": {
        "workflowId": "H3fxaSnxjZT6EGhc",
        "options": {}
      },
      "id": "c17f7e19-7fd3-4f99-98d4-957589a92d63",
      "name": "document",
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1,
      "position": [
        -2180,
        0
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose"
                },
                "conditions": [
                  {
                    "leftValue": "={{ Object.keys($binary).length }}",
                    "rightValue": 0,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose"
                },
                "conditions": [
                  {
                    "id": "50c7e055-c443-4d9f-92b4-14cddaff70d4",
                    "leftValue": "={{ Object.keys($binary).length }}",
                    "rightValue": 1,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose"
                },
                "conditions": [
                  {
                    "id": "33c4ddcf-804c-475e-af1f-fbc77db38a88",
                    "leftValue": "={{ Object.keys($binary).length }}",
                    "rightValue": 2,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose"
                },
                "conditions": [
                  {
                    "id": "4a876fb5-4758-49a5-af1b-e2542b94437e",
                    "leftValue": "={{ Object.keys($binary).length }}",
                    "rightValue": 3,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose"
                },
                "conditions": [
                  {
                    "id": "de3c4e4b-76bf-4738-b259-4e3313b0456b",
                    "leftValue": "={{ Object.keys($binary).length }}",
                    "rightValue": "4",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": "extra",
          "looseTypeValidation": true
        }
      },
      "id": "fa55583e-d20d-4953-87a6-fbf8dac5e918",
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3,
      "position": [
        -1460,
        100
      ]
    }
  ],
  "pinData": {
    "Execute Workflow Trigger": [
      {
        "json": {
          "client": "digitalkin",
          "commandText": "done",
          "date": "2024-02-16T21:09:11.245+01:00",
          "dernierProducteur": "kinrsi",
          "execution": "doing",
          "firstAttribute": "kinrsi",
          "instructions": "[INSTRUCTION - Mettre à jour la TODOLIST et Préparer la Prochaine Étape]TODOLIST mise à jour :\n\n- ACTION 1. **Identification du Kin et Reformulation du Besoin** : DONE\n- ACTION 2. **Définition de l'Approche Globale d'amélioration** : DONE\n- ACTION 3. **Amélioration de la partie \"Instructions Globales\" du prompt du Kin sélectionné** : DONE\n- ACTION 4. **Amélioration de la partie \"Rôle\" du prompt du Kin sélectionné** : DONE\n- ACTION 5. **Amélioration de la partie \"Contexte\" du prompt du Kin sélectionné** : DONE\n- ACTION 6. **Amélioration de la partie \"Proposition de Valeur\" du prompt du Kin sélectionné** : DONE\n- ACTION 7. **Amélioration de la partie \"Système de Balisage des Kins\" du prompt du Kin sélectionné** : DONE\n- ACTION 8. **Amélioration de la rédaction d'une ACTION spécifique du prompt du KinAppelProjet** : DONE\n- ACTION OUVERTE - **Inférences sur les effets attendus sur le Kin** : DONE\n- ACTION OUVERTE : **Réflexion sur le processus de création/amélioration en lui-même** : DONE\n- ACTION 9. **Rapport de Mission & Commentaire** : DONE\n\nProchaine action à réaliser :\n\nVérifier que le \"Rapport de Mission & Commentaire\" satisfait à tous les critères attendus et officiellement conclure la mission si tout est conforme. [/INSTRUCTION - Mettre à jour la TODOLIST et Préparer la Prochaine Étape]",
          "kin": "kinrsi",
          "kinDemandeur": "Lester Reynolds <l.reynolds@digitalkin.ai>",
          "mailFrom": "From: Lester Reynolds <l.reynolds@digitalkin.ai>",
          "mailId": "18db383cdb15c563",
          "mailSubject": "KinAppelProjet",
          "mission": "Subject: KinAppelProjet\nBody: Bonjour KinRSI,\n\nJe voudrais que tu réalises le prompt d'un nouveau Kin, le KinAppelProjet.\n\n*Objectif :* produire une fiche de synthèse pour chaque Appel à Projet\n(AAP) pour permettre à Dynergie de communiquer facilement les sources de\nfinancement possibles à des interlocuteurs internes (consultants,\ncommerciaux) et externes (clients). Il y a environ 1500 AAP par an.\n*Origine des données :* pdf sur le site du financeur (BPI France, ADEME,\nCommission Européenne...) accessible via la fonction GPT\n\"questionneur_de_source\".\n*Processus *: Pour chaque Point du format attendu, Appeler le\nquestionneur_de_source   pour récupérer l'information et écrire le contenu\nentre balises contenu .\n\n# Format attendu\n\n- **Identification de l'AAP**: Nom et description succincte.\n- **Porteurs éligibles**: Critères d'éligibilité des candidats à l'AAP.\n- **Projets éligibles**: Types de projets concernés, critères spécifiques,\net objectifs de réduction d'émissions ou de consommation énergétique.\n- **Objectifs de l'AAP**: Objectifs généraux, leviers de décarbonation\nutilisés.\n- **Domaines ciblés**: Secteurs industriels et thématiques visés.\n- **Contexte et justification**: Contexte réglementaire ou stratégique (ex\n: Green Deal, France 2030).\n- **Modalités de notation des projets**: Formule de calcul de la note,\ncritères d'évaluation.\n- **Lien vers l'AAP**: URL ou référence pour accéder à l'appel à projets\ncomplet.\n- **Date de clôture**: Échéance pour la soumission des projets.\n- **Périodicité**: Information sur la fréquence de renouvellement de l'AAP.\n- **Durée du projet**: Durée attendue ou limite pour la réalisation du\nprojet.\n- **Dépenses éligibles**: Types de dépenses qui peuvent être financées.\n- **Budget du projet**: Montants minimum et maximum de financement.\n- **Taux d’aide maximum**: Pourcentage maximal de financement par type de\nprojet.\n- **Modalités de financement**: Type de soutien financier (ex :\nsubventions).\n\n-- \nNicolas Lester Reynolds\nCPO @ Digitalkin.ai <https://DigitalKin.ai>\n+33621636737\nBookez-moi sur Calendy <https://calendly.com/l-reynolds-digitalkin/call>",
          "missionId": "7b72f70e-7c94-4720-9f99-15c8cd031bb2",
          "sourceGoogleDriveId": "null",
          "status": "done",
          "threadFrom": "Lester Reynolds <l.reynolds@digitalkin.ai>",
          "threadId": "18db37a0a97acbef",
          "threadSubject": "KinAppelProjet"
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "any"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2023-12-17T10:07:55.424Z",
      "updatedAt": "2023-12-20T20:25:13.009Z",
      "id": "DzuSxffpFOEBRhld",
      "name": "outil"
    },
    {
      "createdAt": "2024-01-21T09:47:18.925Z",
      "updatedAt": "2024-01-21T09:47:18.925Z",
      "id": "G7odwuwbJmUt0XX2",
      "name": "prod"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2024-02-16T22:51:33.000Z",
  "versionId": "f8e2e6d2-9a97-47c5-9267-f47b200924e1"
}